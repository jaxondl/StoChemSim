(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     35082,        818]
NotebookOptionsPosition[     28261,        681]
NotebookOutlinePosition[     34141,        803]
CellTagsIndexPosition[     34098,        800]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Runtime Testing", "Title",
 CellChangeTimes->{{3.8218118558687425`*^9, 
  3.821811857859969*^9}},ExpressionUUID->"771e4224-5196-4d45-b595-\
7bbf2271c3eb"],

Cell[BoxData[
 RowBox[{"<<", "CRNSSA`"}]], "Input",
 CellChangeTimes->{{3.8217961683714457`*^9, 3.8217961690426197`*^9}, {
  3.8218056549308915`*^9, 3.8218056556659265`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d19c391c-346b-4865-8834-4554e24d2bdc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"max", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"resultsOpt", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rxns", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"revrxn", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], "+", 
               RowBox[{"x", "[", "j", "]"}]}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", 
              RowBox[{"RandomReal", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "10"}], "}"}], "]"}], ",", 
              RowBox[{"RandomReal", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "10"}], "}"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "k"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "k"}], "}"}]}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"xInits", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"init", "[", 
            RowBox[{
             RowBox[{"x", "[", "i", "]"}], ",", 
             RowBox[{"RandomInteger", "[", "100", "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "k"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"yInits", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"init", "[", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", 
              RowBox[{"RandomInteger", "[", "100", "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "k"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "k"}], "}"}]}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "rxnsys", ",", "results", ",", "nRxns", ",", 
        "time", ",", "iters", ",", "timePerIter"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rxnsys", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"rxns", ",", "xInits", ",", "yInits"}], "}"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"results", "=", 
        RowBox[{"Timing", "[", 
         RowBox[{"DirectSSA", "[", 
          RowBox[{"rxnsys", ",", 
           RowBox[{"100", "/", 
            RowBox[{"(", 
             RowBox[{"k", "^", "2"}], ")"}]}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nRxns", "=", 
        RowBox[{"Length", "[", "rxns", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"results", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"iters", "=", 
        RowBox[{
         RowBox[{"Dimensions", "[", 
          RowBox[{
           RowBox[{"results", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"timePerIter", "=", 
        RowBox[{"time", "/", "iters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"nRxns", ",", "time", ",", "iters", ",", "timePerIter"}], 
        "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "max", ",", "3"}], "}"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.821797966775874*^9, 3.8217980877460546`*^9}, {
   3.821798248932952*^9, 3.8217982981152077`*^9}, {3.8217983958003964`*^9, 
   3.821798399327534*^9}, {3.8217984724853706`*^9, 3.8217984725412226`*^9}, {
   3.821798503667543*^9, 3.821798511564129*^9}, {3.821798559747197*^9, 
   3.8217985619781947`*^9}, {3.821799087603123*^9, 3.821799143618042*^9}, {
   3.821799189625313*^9, 3.821799194600937*^9}, {3.8217992296742077`*^9, 
   3.8217994313486457`*^9}, {3.8217994778855968`*^9, 3.821799521483619*^9}, {
   3.8218008893658094`*^9, 3.821800891055504*^9}, {3.8218009263904643`*^9, 
   3.821800962505397*^9}, {3.821804677855088*^9, 3.8218046779507995`*^9}, 
   3.8218047611834345`*^9, {3.8218051139810495`*^9, 3.8218051141256285`*^9}, 
   3.8218052859094048`*^9, {3.8218053323809214`*^9, 3.821805332804659*^9}, 
   3.821805413492322*^9, {3.8218055499667144`*^9, 3.821805553108056*^9}, {
   3.8218056889955063`*^9, 3.8218056890479484`*^9}, {3.8218060102193584`*^9, 
   3.8218060135624137`*^9}, {3.8218060631318936`*^9, 
   3.8218060640186996`*^9}, {3.8218081482051935`*^9, 
   3.8218081489881277`*^9}, {3.8218085049007015`*^9, 3.821808505187933*^9}, {
   3.8218108686403885`*^9, 3.8218108738875046`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"526b13df-6758-4062-984a-6f0488aa1b7a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2", ",", "0.84375`", ",", "160863", ",", "5.245146491113557`*^-6"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "32", ",", "0.890625`", ",", "67456", ",", "0.000013203050877609108`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "98", ",", "1.46875`", ",", "45231", ",", "0.00003247219827109726`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "200", ",", "2.96875`", ",", "46761", ",", "0.00006348773550608414`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "338", ",", "2.75`", ",", "46709", ",", "0.00005887516324477082`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "512", ",", "4.59375`", ",", "53715", ",", "0.00008552080424462441`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "722", ",", "6.03125`", ",", "50182", ",", "0.00012018751743653102`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "968", ",", "9.28125`", ",", "52463", ",", "0.00017691039399195623`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1250", ",", "14.15625`", ",", "51594", ",", "0.00027437783463193395`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.821801933928444*^9, 3.8218047261274614`*^9, 
  3.8218052074798064`*^9, 3.821805295610742*^9, 3.82180534013931*^9, 
  3.821805436191786*^9, 3.821805578551755*^9, 3.821805668358952*^9, 
  3.8218057148452597`*^9, 3.821806034814495*^9, 3.8218061125794287`*^9, 
  3.821808227728857*^9, 3.8218091107928896`*^9, 3.821810933597999*^9, 
  3.8218110002895737`*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"745f96c7-dae6-4482-9404-b1a3a8518bbf"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Remove", "[", "rxn", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "revrxn", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CRNSimulatorSSA`"}]}], "Input",
 CellChangeTimes->{{3.821808040426386*^9, 3.8218080717058787`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"285efe1d-9e47-4a1a-b3a0-69da1d2f1ffe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"resultsSolo", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rxns", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"revrxn", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], "+", 
               RowBox[{"x", "[", "j", "]"}]}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", 
              RowBox[{"RandomReal", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "10"}], "}"}], "]"}], ",", 
              RowBox[{"RandomReal", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "10"}], "}"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "k"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "k"}], "}"}]}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"xInits", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"conc", "[", 
            RowBox[{
             RowBox[{"x", "[", "i", "]"}], ",", 
             RowBox[{"RandomInteger", "[", "100", "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "k"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"yInits", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"conc", "[", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", 
              RowBox[{"RandomInteger", "[", "100", "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "k"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "k"}], "}"}]}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "rxnsys", ",", "results", ",", "nRxns", ",", 
        "time", ",", "iters", ",", "timePerIter"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rxnsys", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"rxns", ",", "xInits", ",", "yInits"}], "}"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"results", "=", 
        RowBox[{"Timing", "[", 
         RowBox[{"SimulateRxnsysSSA", "[", 
          RowBox[{"rxnsys", ",", 
           RowBox[{"100", "/", 
            RowBox[{"(", 
             RowBox[{"k", "^", "2"}], ")"}]}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nRxns", "=", 
        RowBox[{"Length", "[", "rxns", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"results", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"iters", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"Normal", "[", 
          RowBox[{"results", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"timePerIter", "=", 
        RowBox[{"time", "/", "iters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"nRxns", ",", "time", ",", "iters", ",", "timePerIter"}], 
        "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "max", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8218081243322573`*^9, 3.8218081294007716`*^9}, {
  3.8218108939922104`*^9, 3.8218108969189835`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"edfe87e4-672e-4240-8a97-3a29419ae4d9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2", ",", "0.40625`", ",", "74469", ",", "5.455290120721374`*^-6"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "32", ",", "1.546875`", ",", "69755", ",", "0.000022175829689627983`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "98", ",", "3.453125`", ",", "43465", ",", "0.00007944610606234902`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "200", ",", "7.421875`", ",", "44285", ",", "0.000167593428926273`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "338", ",", "14.890625`", ",", "50128", ",", "0.0002970520467602937`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "512", ",", "22.6875`", ",", "49310", ",", "0.00046009937132427504`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "722", ",", "33.96875`", ",", "49347", ",", "0.0006883650475206193`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "968", ",", "50.265625`", ",", "52455", ",", "0.0009582618434848917`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1250", ",", "65.921875`", ",", "52666", ",", "0.0012516970151520905`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8218084070006833`*^9, 3.821810776292657*^9, 
  3.821811396884431*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"ab1b80ca-4ce9-41d8-9402-1ca66f074ad7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"coorsOpt", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"resultsOpt", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"resultsOpt", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "resultsOpt", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coorsSolo", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"resultsSolo", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"resultsSolo", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "resultsSolo", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"coorsOpt", ",", "coorsSolo"}], "}"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Optimized\>\"", ",", "\"\<Naive\>\""}], "}"}]}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Number of Reactions\>\"", ",", "\"\<Time per Iteration [s]\>\""}], 
     "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8218010077352743`*^9, 3.821801037884249*^9}, {
   3.821801151491223*^9, 3.821801220699094*^9}, {3.821801307337932*^9, 
   3.8218013366180377`*^9}, {3.821801436072702*^9, 3.8218014648894205`*^9}, 
   3.8218015121850615`*^9, {3.821804557576136*^9, 3.8218045652945814`*^9}, {
   3.8218051285103927`*^9, 3.8218051405638013`*^9}, {3.82180520743692*^9, 
   3.8218052088281965`*^9}, 3.8218053591723266`*^9, {3.821805521635069*^9, 
   3.8218055352919903`*^9}, {3.8218055910442066`*^9, 3.821805609850041*^9}, {
   3.8218062481780663`*^9, 3.8218062639926567`*^9}, {3.8218081625549817`*^9, 
   3.82180819013552*^9}, {3.8218082734283347`*^9, 3.8218082769801445`*^9}, {
   3.8218083283873158`*^9, 3.8218083772832365`*^9}, {3.8218084658510942`*^9, 
   3.821808474171357*^9}, {3.8218106596000566`*^9, 3.821810691462716*^9}, 
   3.8218109651445436`*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"97aad75a-6320-4a34-9d18-0b0a1d1b96b7"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{}, {{{}, {}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[7, 360], 0.019444444444444445`]], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        LineBox[{{2., 5.245146491113557*^-6}, {32., 
         0.000013203050877609108`}, {98., 0.00003247219827109726}, {200., 
         0.00006348773550608414}, {338., 0.00005887516324477082}, {512., 
         0.00008552080424462441}, {722., 0.00012018751743653102`}, {968., 
         0.00017691039399195623`}, {1250., 0.00027437783463193395`}}]}, {
        Hue[0.9060679774997897, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[7, 360], 0.019444444444444445`]], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        LineBox[{{2., 5.455290120721374*^-6}, {32., 
         0.000022175829689627983`}, {98., 0.00007944610606234902}, {200., 
         0.000167593428926273}, {338., 0.0002970520467602937}, {512., 
         0.00046009937132427504`}, {722., 0.0006883650475206193}, {968., 
         0.0009582618434848917}, {1250., 
         0.0012516970151520905`}}]}}}, {{}, {}}}, {
    DisplayFunction -> Identity, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {
       FormBox["\"Number of Reactions\"", TraditionalForm], 
       FormBox["\"Time per Iteration [s]\"", TraditionalForm]}, 
     AxesOrigin -> {0, 0}, DisplayFunction :> Identity, 
     Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{0, 1250.}, {0, 0.0012516970151520905`}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}], 
   FormBox[
    FormBox[
     TemplateBox[{"\"Optimized\"", "\"Naive\""}, "LineLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["7", "360"], "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.368417`", ",", "0.506779`", ",", "0.709798`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["7", "360"], "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.880722`", ",", "0.611041`", ",", "0.142051`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"True", ",", "True"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{3.821810776730529*^9, 3.821810825043602*^9, 
  3.8218113972790504`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"685e9f3b-77e3-466e-8517-c8dff1df2075"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8218086954424286`*^9, 
  3.8218086973537536`*^9}},ExpressionUUID->"dc84c69e-ef58-4288-8a6a-\
115d840d749c"]
}, Open  ]]
},
WindowSize->{1440., 747.75},
WindowMargins->{{Automatic, 957}, {Automatic, -6}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
InputAliases->{"intt" -> RowBox[{"\[Integral]", 
     RowBox[{"\[SelectionPlaceholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "dintt" -> RowBox[{
     SubsuperscriptBox[
     "\[Integral]", "\[SelectionPlaceholder]", "\[Placeholder]"], 
     RowBox[{"\[Placeholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "rintt" -> RowBox[{
     UnderscriptBox["\[Integral]", 
      RowBox[{"\[SelectionPlaceholder]", "\[Element]", "\[Placeholder]"}]], 
     "\[Placeholder]"}], "sumt" -> RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "prodt" -> RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "dt" -> RowBox[{
     SubscriptBox["\[PartialD]", "\[Placeholder]"], " ", 
     "\[SelectionPlaceholder]"}], "cbrt" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "3", SurdForm -> True, MultilineFunction -> 
    None], "surd" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "\[Placeholder]", SurdForm -> True, 
    MultilineFunction -> None], "ket" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Ket"], "bra" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Bra"], "braket" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, "BraKet"], 
  "delay" -> TemplateBox[{"\[SelectionPlaceholder]"}, "SystemsModelDelay"], 
  "grad" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Placeholder]"}], 
  "del." -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], ".", 
     "\[Placeholder]"}], "delx" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Cross]", 
     "\[Placeholder]"}], "del2" -> RowBox[{
     SubsuperscriptBox["\[Del]", "\[SelectionPlaceholder]", 2], 
     "\[Placeholder]"}], "kd" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "KroneckerDeltaSeq"], "algs" -> 
  TemplateBox[{}, "Algebraics"], "bools" -> TemplateBox[{}, "Booleans"], 
  "comps" -> TemplateBox[{}, "Complexes"], "ints" -> 
  TemplateBox[{}, "Integers"], "pris" -> TemplateBox[{}, "Primes"], "rats" -> 
  TemplateBox[{}, "Rationals"], "reals" -> TemplateBox[{}, "Reals"], "pints" -> 
  TemplateBox[{}, "PositiveIntegers"], "npints" -> 
  TemplateBox[{}, "NonPositiveIntegers"], "nnints" -> 
  TemplateBox[{}, "NonNegativeIntegers"], "nints" -> 
  TemplateBox[{}, "NegativeIntegers"], "prats" -> 
  TemplateBox[{}, "PositiveRationals"], "nprats" -> 
  TemplateBox[{}, "NonPositiveRationals"], "nnrats" -> 
  TemplateBox[{}, "NonNegativeRationals"], "nrats" -> 
  TemplateBox[{}, "NegativeRationals"], "preals" -> 
  TemplateBox[{}, "PositiveReals"], "npreals" -> 
  TemplateBox[{}, "NonPositiveReals"], "nnreals" -> 
  TemplateBox[{}, "NonNegativeReals"], "nreals" -> 
  TemplateBox[{}, "NegativeReals"], "dlim" -> RowBox[{
     UnderscriptBox["\[Limit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dMlim" -> RowBox[{
     UnderscriptBox["\[MaxLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dmlim" -> RowBox[{
     UnderscriptBox["\[MinLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "tue" -> OverscriptBox["\[UndirectedEdge]", "\[Placeholder]"], "tde" -> 
  OverscriptBox["\[DirectedEdge]", "\[Placeholder]"], "notation" -> 
  RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation>" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation<" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "symb" -> RowBox[{"Symbolize", "[", 
     TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], "]"}], 
  "infixnotation" -> RowBox[{"InfixNotation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], ",", 
       "\[Placeholder]"}], "]"}], "addia" -> RowBox[{"AddInputAlias", "[", 
     RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "pattwraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationPatternTag"], 
  "madeboxeswraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationMadeBoxesTag"], "rxn" -> 
  RowBox[{"\[Placeholder]", " ", 
     OverscriptBox["\[RightArrow]", 
      RowBox[{" ", "\[Placeholder]", " "}]], " ", "\[Placeholder]", " "}], 
  "revrxn" -> RowBox[{"\[Placeholder]", " ", 
     UnderoverscriptBox[
     "\[RightArrowLeftArrow]", "\[Placeholder]", "\[Placeholder]"], " ", 
     "\[Placeholder]", " "}]},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f23d6fbc-8a22-41cf-879a-3ab05f213427"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 160, 3, 97, "Title",ExpressionUUID->"771e4224-5196-4d45-b595-7bbf2271c3eb"],
Cell[743, 27, 252, 4, 28, "Input",ExpressionUUID->"d19c391c-346b-4865-8834-4554e24d2bdc"],
Cell[CellGroupData[{
Cell[1020, 35, 4889, 110, 254, "Input",ExpressionUUID->"526b13df-6758-4062-984a-6f0488aa1b7a"],
Cell[5912, 147, 1620, 45, 58, "Output",ExpressionUUID->"745f96c7-dae6-4482-9404-b1a3a8518bbf"]
}, Open  ]],
Cell[7547, 195, 371, 7, 66, "Input",ExpressionUUID->"285efe1d-9e47-4a1a-b3a0-69da1d2f1ffe"],
Cell[CellGroupData[{
Cell[7943, 206, 3633, 90, 235, "Input",ExpressionUUID->"edfe87e4-672e-4240-8a97-3a29419ae4d9"],
Cell[11579, 298, 1339, 41, 58, "Output",ExpressionUUID->"ab1b80ca-4ce9-41d8-9402-1ca66f074ad7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12955, 344, 2499, 61, 66, "Input",ExpressionUUID->"97aad75a-6320-4a34-9d18-0b0a1d1b96b7"],
Cell[15457, 407, 12617, 265, 187, "Output",ExpressionUUID->"685e9f3b-77e3-466e-8517-c8dff1df2075"]
}, Open  ]],
Cell[28089, 675, 156, 3, 28, "Input",ExpressionUUID->"dc84c69e-ef58-4288-8a6a-115d840d749c"]
}, Open  ]]
}
]
*)

